<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Job Application Tracker</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .kanban-column {
            min-width: 240px;
            flex: 1;
        }
        .job-card {
            cursor: grab;
            transition: all 0.2s ease-in-out;
        }
        .job-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }
        .job-card.dragging {
            opacity: 0.5;
            transform: rotate(2deg);
        }
        .modal-backdrop {
            transition: opacity 0.3s ease;
        }
        /* Custom scrollbar for webkit browsers */
        .sidebar-nav::-webkit-scrollbar {
            width: 4px;
        }
        .sidebar-nav::-webkit-scrollbar-thumb {
            background-color: #4a5568;
            border-radius: 20px;
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">

    <!-- Main Container -->
    <div id="app" class="flex h-screen">

        <!-- Sidebar -->
        <aside class="w-64 flex-shrink-0 bg-gray-800 text-white flex flex-col">
            <!-- Logo -->
            <div class="flex items-center justify-center h-16 border-b border-gray-700 flex-shrink-0">
                 <div class="flex items-center space-x-3">
                    <svg class="w-8 h-8 text-indigo-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M21 7.5l-9-5.25L3 7.5m18 0l-9 5.25m9-5.25v9l-9 5.25M3 7.5l9 5.25M3 7.5v9l9 5.25m0-9v9" />
                    </svg>
                    <h1 class="text-2xl font-bold text-white">JobTrackr</h1>
                </div>
            </div>
            <!-- Navigation -->
            <nav class="flex-1 overflow-y-auto sidebar-nav p-4 space-y-2">
                <a href="#" class="flex items-center px-4 py-2 text-gray-100 bg-gray-700 rounded-lg">
                    <svg class="w-5 h-5 mr-3" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 12l8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h7.5" />
                    </svg>
                    Dashboard
                </a>
                <a href="#" class="flex items-center px-4 py-2 text-gray-300 hover:bg-gray-700 hover:text-white rounded-lg transition-colors">
                    <svg class="w-5 h-5 mr-3" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 3v11.25A2.25 2.25 0 006 16.5h12A2.25 2.25 0 0020.25 14.25V3M3.75 21h16.5M12 3v18" />
                    </svg>
                    Analytics
                </a>
                <a href="#" class="flex items-center px-4 py-2 text-gray-300 hover:bg-gray-700 hover:text-white rounded-lg transition-colors">
                    <svg class="w-5 h-5 mr-3" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 012.25-2.25h13.5A2.25 2.25 0 0121 7.5v11.25m-18 0A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75m-18 0h18M12 12.75h.008v.008H12v-.008z" />
                    </svg>
                    Calendar
                </a>
                <a href="#" class="flex items-center px-4 py-2 text-gray-300 hover:bg-gray-700 hover:text-white rounded-lg transition-colors">
                    <svg class="w-5 h-5 mr-3" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M10.343 3.94c.09-.542.56-1.007 1.11-1.226l.558-.223c.55-.22 1.158-.22 1.708 0l.558.223c.549.22 1.02.684 1.11 1.226l.09.542-.09.542c-.09.542-.56 1.007-1.11 1.226l-.558.223c-.55.22-1.158.22-1.708 0l-.558-.223c-.549-.22-1.02-.684-1.11-1.226l-.09-.542z" />
                        <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 15.75l-2.071-2.071a4.5 4.5 0 00-6.364-6.364l-2.071-2.071M15.75 15.75v-1.875a3.375 3.375 0 00-3.375-3.375h-1.875m-1.5-1.5l-2.071-2.071a4.5 4.5 0 00-6.364 6.364l2.071 2.071" />
                    </svg>
                    Settings
                </a>
            </nav>
            <!-- User Profile -->
            <div class="p-4 border-t border-gray-700 flex-shrink-0">
                <a href="#" class="flex items-center group">
                    <img class="h-10 w-10 rounded-full object-cover" src="https://placehold.co/100x100/7c3aed/ffffff?text=U" alt="User avatar">
                    <div class="ml-3">
                        <p class="text-sm font-medium text-white">User Name</p>
                        <p class="text-xs font-medium text-gray-400 group-hover:text-gray-300 transition-colors">View profile</p>
                    </div>
                </a>
            </div>
        </aside>

        <!-- Content Wrapper -->
        <div class="flex-1 flex flex-col overflow-hidden">
            <!-- Header -->
            <header class="bg-white border-b border-gray-200 shadow-sm">
                <div class="max-w-full mx-auto px-4 sm:px-6 lg:px-8">
                    <div class="flex justify-end items-center h-16">
                        <div class="flex items-center space-x-4">
                             <button id="add-new-btn" class="inline-flex items-center justify-center rounded-md bg-indigo-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2">
                                <svg class="-ml-1 mr-2 h-5 w-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                                    <path d="M10.75 4.75a.75.75 0 00-1.5 0v4.5h-4.5a.75.75 0 000 1.5h4.5v4.5a.75.75 0 001.5 0v-4.5h4.5a.75.75 0 000-1.5h-4.5v-4.5z" />
                                </svg>
                                New Application
                            </button>
                        </div>
                    </div>
                </div>
            </header>

            <!-- Main Content -->
            <main class="flex-1 overflow-x-auto p-4 sm:p-6 lg:p-8">
                <div id="kanban-board" class="flex space-x-6 h-full">
                    <!-- Kanban Columns will be injected by JavaScript -->
                </div>
            </main>
        </div>
    </div>

    <!-- Add New Application Modal -->
    <div id="modal" class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 modal-backdrop hidden opacity-0">
        <div class="bg-white rounded-lg shadow-xl w-full max-w-md m-4 transform transition-all scale-95 opacity-0" id="modal-panel">
            <div class="p-6">
                <div class="flex justify-between items-start">
                    <h2 class="text-2xl font-bold text-gray-900">Add New Application</h2>
                    <button id="close-modal-btn" class="text-gray-400 hover:text-gray-600">
                        <svg class="w-6 h-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                        </svg>
                    </button>
                </div>
                <form id="new-job-form" class="mt-6 space-y-4">
                    <div>
                        <label for="company" class="block text-sm font-medium text-gray-700">Company</label>
                        <input type="text" id="company" name="company" required class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm">
                    </div>
                    <div>
                        <label for="job-title" class="block text-sm font-medium text-gray-700">Job Title</label>
                        <input type="text" id="job-title" name="job-title" required class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm">
                    </div>
                    <div>
                        <label for="job-url" class="block text-sm font-medium text-gray-700">Job Post URL</label>
                        <input type="url" id="job-url" name="job-url" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm">
                    </div>
                    <div>
                        <label for="status" class="block text-sm font-medium text-gray-700">Status</label>
                        <select id="status" name="status" class="mt-1 block w-full rounded-md border-gray-300 py-2 pl-3 pr-10 text-base focus:border-indigo-500 focus:outline-none focus:ring-indigo-500 sm:text-sm">
                            <!-- Options will be populated by JS -->
                        </select>
                    </div>
                    <div class="flex justify-end pt-4">
                        <button type="submit" class="inline-flex items-center justify-center rounded-md bg-indigo-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2">
                            Add Application
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- STATE & DATA ---
            const columns = {
                'wishlist': { title: 'Wishlist', color: 'bg-gray-200', textColor: 'text-gray-700' },
                'applied': { title: 'Applied', color: 'bg-blue-200', textColor: 'text-blue-800' },
                'interviewing': { title: 'Interviewing', color: 'bg-yellow-200', textColor: 'text-yellow-800' },
                'offer': { title: 'Offer', color: 'bg-green-200', textColor: 'text-green-800' },
                'rejected': { title: 'Rejected', color: 'bg-red-200', textColor: 'text-red-800' },
            };

            // Sample data to simulate what would come from a database
            let jobs = [
                { id: 1, company: 'Google', title: 'Frontend Engineer', status: 'interviewing', date: '2025-08-01' },
                { id: 2, company: 'Meta', title: 'Full Stack Developer', status: 'applied', date: '2025-07-28' },
                { id: 3, company: 'Netflix', title: 'Product Manager', status: 'wishlist', date: '2025-08-05' },
                { id: 4, company: 'Amazon', title: 'Cloud Architect', status: 'rejected', date: '2025-07-15' },
                { id: 5, company: 'Apple', title: 'iOS Developer', status: 'applied', date: '2025-08-02' },
                { id: 6, company: 'Microsoft', title: 'Software Engineer', status: 'offer', date: '2025-07-20' },
            ];

            // --- DOM ELEMENTS ---
            const kanbanBoard = document.getElementById('kanban-board');
            const modal = document.getElementById('modal');
            const modalPanel = document.getElementById('modal-panel');
            const addNewBtn = document.getElementById('add-new-btn');
            const closeModalBtn = document.getElementById('close-modal-btn');
            const newJobForm = document.getElementById('new-job-form');
            const statusSelect = document.getElementById('status');

            // --- FUNCTIONS ---

            /**
             * Renders all columns and job cards to the board.
             * This function is the main entry point for displaying data.
             */
            const renderBoard = () => {
                kanbanBoard.innerHTML = ''; // Clear the board before re-rendering
                
                Object.keys(columns).forEach(statusKey => {
                    const columnData = columns[statusKey];
                    const columnEl = createColumnElement(statusKey, columnData);
                    
                    const jobsInColumn = jobs.filter(job => job.status === statusKey);
                    const cardsContainer = columnEl.querySelector('.cards-container');

                    jobsInColumn.forEach(job => {
                        const cardEl = createJobCardElement(job);
                        cardsContainer.appendChild(cardEl);
                    });

                    kanbanBoard.appendChild(columnEl);
                });
                
                // Re-attach drag and drop listeners after rendering
                setupDragAndDrop();
            };

            /**
             * Creates the HTML for a single Kanban column.
             * @param {string} statusKey - The key for the column (e.g., 'applied').
             * @param {object} columnData - The column's metadata (title, color).
             * @returns {HTMLElement} The created column element.
             */
            const createColumnElement = (statusKey, columnData) => {
                const columnWrapper = document.createElement('div');
                columnWrapper.className = 'kanban-column flex flex-col bg-gray-100 rounded-lg h-full';
                columnWrapper.dataset.status = statusKey;
                
                columnWrapper.innerHTML = `
                    <div class="p-4 border-b border-gray-200">
                        <div class="flex justify-between items-center">
                            <h2 class="text-lg font-semibold ${columnData.textColor}">${columnData.title}</h2>
                            <span class="text-sm font-medium ${columnData.color} ${columnData.textColor} rounded-full px-2 py-1">
                                ${jobs.filter(j => j.status === statusKey).length}
                            </span>
                        </div>
                    </div>
                    <div class="cards-container flex-1 p-4 space-y-4 overflow-y-auto">
                        <!-- Job cards go here -->
                    </div>
                `;
                return columnWrapper;
            };

            /**
             * Creates the HTML for a single job application card.
             * @param {object} job - The job data object.
             * @returns {HTMLElement} The created card element.
             */
            const createJobCardElement = (job) => {
                const card = document.createElement('div');
                card.className = 'job-card bg-white rounded-lg p-4 shadow-sm border border-gray-200';
                card.draggable = true;
                card.dataset.jobId = job.id;

                const columnData = columns[job.status];
                card.innerHTML = `
                    <div class="flex justify-between items-start">
                        <h3 class="font-bold text-gray-900">${job.company}</h3>
                        <span class="text-xs font-semibold px-2 py-1 rounded-full ${columnData.color} ${columnData.textColor}">${columnData.title}</span>
                    </div>
                    <p class="text-sm text-gray-600 mt-1">${job.title}</p>
                    <p class="text-xs text-gray-400 mt-3">Applied: ${new Date(job.date).toLocaleDateString()}</p>
                `;
                return card;
            };

            /**
             * Sets up all drag and drop event listeners for the job cards and columns.
             */
            const setupDragAndDrop = () => {
                const cards = document.querySelectorAll('.job-card');
                const columns = document.querySelectorAll('.kanban-column .cards-container');

                cards.forEach(card => {
                    card.addEventListener('dragstart', () => {
                        card.classList.add('dragging');
                    });

                    card.addEventListener('dragend', () => {
                        card.classList.remove('dragging');
                    });
                });

                columns.forEach(column => {
                    column.addEventListener('dragover', e => {
                        e.preventDefault();
                        const afterElement = getDragAfterElement(column, e.clientY);
                        const dragging = document.querySelector('.dragging');
                        if (afterElement == null) {
                            column.appendChild(dragging);
                        } else {
                            column.insertBefore(dragging, afterElement);
                        }
                    });

                    column.addEventListener('drop', e => {
                        e.preventDefault();
                        const draggingCard = document.querySelector('.dragging');
                        const jobId = parseInt(draggingCard.dataset.jobId);
                        const newStatus = column.closest('.kanban-column').dataset.status;

                        // Update the job's status in our data
                        const jobToUpdate = jobs.find(j => j.id === jobId);
                        if (jobToUpdate) {
                            jobToUpdate.status = newStatus;
                        }
                        
                        // Re-render the entire board to reflect changes and update counts
                        renderBoard();
                    });
                });
            };
            
            /**
             * Helper function to determine where to drop a card within a column.
             */
            const getDragAfterElement = (container, y) => {
                const draggableElements = [...container.querySelectorAll('.job-card:not(.dragging)')];

                return draggableElements.reduce((closest, child) => {
                    const box = child.getBoundingClientRect();
                    const offset = y - box.top - box.height / 2;
                    if (offset < 0 && offset > closest.offset) {
                        return { offset: offset, element: child };
                    } else {
                        return closest;
                    }
                }, { offset: Number.NEGATIVE_INFINITY }).element;
            };

            /**
             * Opens the 'Add New Application' modal with a smooth transition.
             */
            const openModal = () => {
                modal.classList.remove('hidden');
                setTimeout(() => {
                    modal.classList.remove('opacity-0');
                    modalPanel.classList.remove('scale-95', 'opacity-0');
                }, 10);
            };

            /**
             * Closes the modal with a smooth transition.
             */
            const closeModal = () => {
                modalPanel.classList.add('scale-95', 'opacity-0');
                modal.classList.add('opacity-0');
                setTimeout(() => {
                    modal.classList.add('hidden');
                }, 300);
            };
            
            /**
             * Populates the status dropdown in the modal form.
             */
            const populateStatusDropdown = () => {
                statusSelect.innerHTML = '';
                Object.keys(columns).forEach(statusKey => {
                    const option = document.createElement('option');
                    option.value = statusKey;
                    option.textContent = columns[statusKey].title;
                    statusSelect.appendChild(option);
                });
            };

            /**
             * Handles the submission of the new job form.
             */
            const handleFormSubmit = (e) => {
                e.preventDefault();
                const formData = new FormData(newJobForm);
                const newJob = {
                    id: Date.now(), // Use timestamp for a unique ID
                    company: formData.get('company'),
                    title: formData.get('job-title'),
                    status: formData.get('status'),
                    date: new Date().toISOString().split('T')[0], // Today's date
                    url: formData.get('job-url')
                };
                jobs.push(newJob);
                newJobForm.reset();
                closeModal();
                renderBoard();
            };

            // --- EVENT LISTENERS ---
            addNewBtn.addEventListener('click', openModal);
            closeModalBtn.addEventListener('click', closeModal);
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    closeModal();
                }
            });
            newJobForm.addEventListener('submit', handleFormSubmit);

            // --- INITIALIZATION ---
            populateStatusDropdown();
            renderBoard();
        });
    </script>
</body>
</html>
